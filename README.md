F1 25 Telemetry Viewer
======================

Проект для просмотра телеметрии F1 25 (PS5) с любого устройства в локальной сети:

- Прием UDP-пакетов от игры.
- Подсчет данных по кругам: live time текущего круга, best time, таблица кругов (номер, время, дельта, валидность) и так далее.

## Структура проекта

- `backend/` — Node.js-сервер:
  - слушает UDP от игры;
  - парсит нужные пакеты (минимум LapData);
  - считает best lap, дельты и валидность;
  - отдает данные по WebSocket и раздает статику из `public/`.
- `public/` — простой фронтенд:
  - `index.html` — разметка;
  - `style.css` — стили;
  - `app.js` — подключение к WebSocket и отрисовка таблицы кругов.

## Описание работы

- В демо-режиме (`npm run demo`) сервер генерирует синтетические данные без подключения к игре.

### Интерфейс

- Метрики: `Live lap` (live-время текущего круга), `Best lap (personal)` (лучший личный круг и номер), `Delta vs best` (разница с личным лучшим), `Best lap (overall)` (лучший круг по сессии и номер).
- Блок `Fuel / ERS / Penalties`: запас топлива в кругах относительно оставшейся дистанции и активный режим топлива; процент заряда ERS от константы; перечень штрафов, предупреждений и необслуженных наказаний.
- Вкладка `Race`: таблица машин с позициями, разрывами, шинами (стек смен), количеством пит-стопов, статусом пит-стопа, секторами и дельтой позиций относительно первоначальной позиции. Лучший круг и лучшие сектора сессии подсвечиваются.
- Вкладка `Personal`: live-строка текущего круга и история кругов игрока с дельтой к личному лучшему, шинами (стек смен), пит-стопами, секторами и валидностью.
- Вкладка `Car`: текущие статусы машины игрока (топливо, шины, управление, ERS, мощности, температуры, давления) и телеметрия (скорость, педали, передачи, обороты).
- Отображается статус подключения и тип сессии.

### Логика данных

- `liveLapTimeMs` получено из LapData `currentLapTimeInMS`; `liveDeltaToBestMs` — разница между личным лучшим кругом и текущим временем круга.
- Личные лучшие сектора обновляются при завершении сектора на валидном круге.
- История кругов хранится по номеру; при откате на более ранний номер круги с большим номером удаляются.
- Пит-стоп фиксируется как стинт: итоговое время и статус привязываются к кругу, в котором таймер pit-lane активировался.
- В practice/qualifying разрыв до машины впереди вычисляется как разница лучших кругов, если отсутствуют корректные ahead-гепы в данных.

## Запуск

1. Установить зависимости:
   ```bash
   npm install
   ```
2. Запустить сервер:
   ```bash
   npm start
   ```
3. (Опционально) Запустить демо-режим без игры:
   ```bash
   npm run demo
   ```
4. В игре F1 25 (PS5) указать IP вашего компьютера и UDP-порт, который будет слушать сервер.


